version: 2.1

orbs:
  node: circleci/node@16.3.1

jobs: 
    angular-test:
      docker:
        - image: circleci/node:16.13.1-bullseye-browsers-legacy
      environment:
        NPM_CONFIG_PREFIX: "~/.npm-global"
      steps:
        - checkout
        - run:
            name: Install Angular CLI
            command: npm install -g @angular/cli@latest
        - run:
            command: npm link @angular/cli
        # - run:
        #     command: curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
        # - run:
        #     command: nvm install latest
        # - run:
        #     command: nvm use latest
        - run:
            name: Change folder
            command: cd ~/project/Frontend
        - run:
            name: Install Angular Dependencies
            command: cd ~/project/Frontend && npm install --force
        - run:
            name: Run Angular Tests
            command: cd ~/project/Frontend && npm run test
workflows:
    backend:
      jobs:
        - node/run:
            pkg-manager: npm 
            resource_class: large 
            app-dir: ~/project/Backend 
            npm-run: test

        - angular-test
  